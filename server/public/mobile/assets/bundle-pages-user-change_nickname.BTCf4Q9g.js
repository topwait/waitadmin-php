import{d as e,H as a,I as s,r as t,J as l,B as n,w as r,c as o,a as d,b as u,e as i,f as m,g as c,h as p,k as f,j as _,G as b,l as g,m as k,t as x,U as h,b0 as v,s as w}from"./index-CbP45Wwt.js";import{_ as y}from"./wd-input.BHaKXBII.js";import{_ as j}from"./wd-button.VA8QVjvr.js";import{_ as I}from"./wd-form.vue_vue_type_script_setup_true_lang.DscUGWD7.js";import"./types.DuL_ynPZ.js";import"./index.CDE1r9Ff.js";import"./index.D9GroqTO.js";import"./useTranslate.BahM4N0k.js";const T=w(e({__name:"change_nickname",setup(e){const w=a(),T=s(),U=t(!1),V=l({nickname:T.userInfo.nickname||""}),z=t(!1),B=t(""),A=n(()=>U.value||!!B.value||!V.nickname),C=async()=>{const e=T.userInfo.nickname;if(V.nickname===e)return w.show("与原昵称一致,无需修改"),!1;U.value=!0,await h.edit({scene:"nickname",value:V.nickname}).then(async()=>{w.show("修改成功"),await T.getUser(),setTimeout(()=>{v()},500)}).catch(()=>{}).finally(()=>{setTimeout(()=>{U.value=!1},800)})};return r(()=>V.nickname,e=>{e?e.length<=1||e.length>20?B.value="昵称长度不合法，应为2-20个字符":B.value="":B.value="昵称不能为空"}),(e,a)=>{const s=i(m("wd-input"),y),t=f,l=i(m("wd-button"),j),n=i(m("wd-form"),I),r=u("global-ku-root");return c(),o(r,null,{default:d(()=>[p(t,{class:"flex-1 p-6 pt-10 border-t border-br-thinned bg-page"},{default:d(()=>[p(n,{ref:"form",model:_(V),class:"w-full"},{default:d(()=>[p(t,{class:b(["p-3.5 rounded-xl bg-lighter border-2",_(B)?"border-danger":_(z)?"border-primary":"border-transparent"])},{default:d(()=>[p(s,{modelValue:_(V).nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>_(V).nickname=e),disabled:_(U),"no-border":!0,prop:"nickname",type:"text",placeholder:"请输入昵称","custom-class":"!bg-transparent",onFocus:a[1]||(a[1]=e=>z.value=!0),onBlur:a[2]||(a[2]=e=>z.value=!1)},null,8,["modelValue","disabled"])]),_:1},8,["class"]),p(t,{class:"pt-2 pl-3 text-sm text-danger h-4.5"},{default:d(()=>[_(B)?(c(),o(t,{key:0},{default:d(()=>[k(x(_(B)),1)]),_:1})):g("",!0)]),_:1}),p(t,{class:"mt-8 px-2 text-sm text-tx-placeholder"},{default:d(()=>[k(" 昵称必须符合国家法律法规，并且长度2~20个字符内容。 ")]),_:1}),p(t,{class:"mt-4"},{default:d(()=>[p(l,{type:"primary",size:"large",block:!0,loading:_(U),disabled:_(A),onClick:C},{default:d(()=>[k(" 确定 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-8777dcff"]]);export{T as default};
