import{d as e,G as a,H as s,r as t,I as l,A as n,w as r,c as o,a as d,b as u,e as i,f as m,g as c,h as p,k as f,j as _,E as b,l as g,m as k,t as x,S as h,a$ as v,q as w}from"./index-4glTkX_N.js";import{_ as y}from"./wd-input.DYf8A7Ki.js";import{_ as j}from"./wd-button.Bm4eyLOH.js";import{_ as I}from"./wd-form.vue_vue_type_script_setup_true_lang.7ThkrgxC.js";import"./types.DQ6PHZfF.js";import"./index.mNFG9pMF.js";import"./index.D9GroqTO.js";import"./useTranslate.By_X5Fzm.js";const T=w(e({__name:"change_nickname",setup(e){const w=a(),T=s(),V=t(!1),z=l({nickname:T.userInfo.nickname||""}),A=t(!1),E=t(""),U=n(()=>V.value||!!E.value||!z.nickname),q=async()=>{const e=T.userInfo.nickname;if(z.nickname===e)return w.show("与原昵称一致,无需修改"),!1;V.value=!0,await h.edit({scene:"nickname",value:z.nickname}).then(async()=>{w.show("修改成功"),await T.getUser(),setTimeout(()=>{v()},500)}).catch(()=>{}).finally(()=>{setTimeout(()=>{V.value=!1},800)})};return r(()=>z.nickname,e=>{e?e.length<=1||e.length>20?E.value="昵称长度不合法，应为2-20个字符":E.value="":E.value="昵称不能为空"}),(e,a)=>{const s=i(m("wd-input"),y),t=f,l=i(m("wd-button"),j),n=i(m("wd-form"),I),r=u("global-ku-root");return c(),o(r,null,{default:d(()=>[p(t,{class:"flex-1 p-6 pt-10 border-t border-br-thinned bg-page"},{default:d(()=>[p(n,{ref:"form",model:_(z),class:"w-full"},{default:d(()=>[p(t,{class:b(["p-3.5 rounded-xl bg-lighter border-2",_(E)?"border-danger":_(A)?"border-primary":"border-transparent"])},{default:d(()=>[p(s,{modelValue:_(z).nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>_(z).nickname=e),disabled:_(V),"no-border":!0,prop:"nickname",type:"text",placeholder:"请输入昵称","custom-class":"!bg-transparent",onFocus:a[1]||(a[1]=e=>A.value=!0),onBlur:a[2]||(a[2]=e=>A.value=!1)},null,8,["modelValue","disabled"])]),_:1},8,["class"]),p(t,{class:"pt-2 pl-3 text-sm text-danger h-4.5"},{default:d(()=>[_(E)?(c(),o(t,{key:0},{default:d(()=>[k(x(_(E)),1)]),_:1})):g("",!0)]),_:1}),p(t,{class:"mt-8 px-2 text-sm text-tx-placeholder"},{default:d(()=>[k(" 昵称必须符合国家法律法规，并且长度2~20个字符内容。 ")]),_:1}),p(t,{class:"mt-4"},{default:d(()=>[p(l,{type:"primary",size:"large",block:!0,loading:_(V),disabled:_(U),onClick:q},{default:d(()=>[k(" 确定 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-8777dcff"]]);export{T as default};
