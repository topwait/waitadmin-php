import{d as e,G as a,r as l,I as s,w as o,c as t,a as r,b as d,e as u,f as i,s as n,g as m,h as p,k as c,l as b,j as f,E as w,m as _,t as x,S as g,a$ as h,q as v}from"./index-4glTkX_N.js";import{_ as y}from"./wd-input.DYf8A7Ki.js";import{_ as j}from"./wd-button.Bm4eyLOH.js";import{_ as k}from"./wd-form.vue_vue_type_script_setup_true_lang.7ThkrgxC.js";import{_ as V,N as B}from"./notice.CpGJXdHh.js";import"./types.DQ6PHZfF.js";import"./index.mNFG9pMF.js";import"./index.D9GroqTO.js";import{v as T}from"./validate.BlYyaBVG.js";import"./useTranslate.By_X5Fzm.js";const z=v(e({__name:"adjust_mobile",setup(e){const v=a(),z=l(!1),I=s({password:"",mobile:"",code:""}),M=l(1),C=l(!1),E=l(!1),F=l(!1),U=l(""),N=async()=>{z.value=!0,await g.checkPwd(I.password).then(e=>{e.status?(v.show("校验通过"),setTimeout(()=>{M.value=2,z.value=!1},600)):v.show("密码校验不通过")}).catch(()=>{}).finally(()=>{setTimeout(()=>{z.value=!1},1e3)})},q=async()=>I.mobile?T.isMobile(I.mobile)?I.code?(z.value=!0,void(await g.bindMobile({password:I.password,mobile:I.mobile,code:I.code}).then(()=>{v.show("修改成功"),setTimeout(()=>{h()},1e3)}).catch(()=>{}).finally(()=>{setTimeout(()=>{z.value=!1},1500)}))):(v.show("请输入验证码"),!1):(v.show("手机号无效"),!1):(v.show("请填写手机号"),!1);return o(()=>I.password,e=>{e?e.length<6||e.length>20?U.value="密码长度不合法":U.value="":U.value="密码不能为空"}),(e,a)=>{const l=u(i("wd-input"),y),s=c,o=u(i("wd-button"),j),g=u(i("wd-form"),k),h=u(i("wd-icon"),n),v=u(i("w-verify-code"),V),T=d("global-ku-root");return m(),t(T,null,{default:r(()=>[p(s,{class:"flex-1 p-6 pt-10 border-t border-br-thinned bg-page"},{default:r(()=>[1===f(M)?(m(),t(g,{key:0,model:f(I),class:"w-full"},{default:r(()=>[p(s,{class:w(["flex items-center p-3.5 rounded-xl bg-lighter border-2",f(U)?"border-danger":f(C)?"border-primary":"border-transparent"])},{default:r(()=>[p(l,{modelValue:f(I).password,"onUpdate:modelValue":a[0]||(a[0]=e=>f(I).password=e),disabled:f(z),"no-border":!0,prop:"password","show-password":"",placeholder:"请输入登录密码","custom-class":"flex-1 !bg-transparent",onFocus:a[1]||(a[1]=e=>C.value=!0),onBlur:a[2]||(a[2]=e=>C.value=!1)},null,8,["modelValue","disabled"])]),_:1},8,["class"]),p(s,{class:"pt-2 pl-3 text-sm text-danger h-4.5"},{default:r(()=>[f(U)?(m(),t(s,{key:0},{default:r(()=>[_(x(f(U)),1)]),_:1})):b("",!0)]),_:1}),p(s,{class:"mt-8 px-2 text-sm text-tx-placeholder"},{default:r(()=>[_(" 为了确保您是账户拥有者，现需要对您进行登录密码安全检验， 验证通过后方可进行修改。 ")]),_:1}),p(s,{class:"mt-6"},{default:r(()=>[p(o,{type:"primary",size:"large",block:!0,loading:f(z),disabled:f(z)||!f(I).password,onClick:N},{default:r(()=>[_(" 开始校验 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])):b("",!0),2===f(M)?(m(),t(g,{key:1,model:f(I),class:"w-full"},{default:r(()=>[p(s,{class:w(["flex items-center p-3.5 rounded-xl bg-lighter border-2",f(F)?"border-primary":"border-transparent"])},{default:r(()=>[p(s,{class:"flex items-center"},{default:r(()=>[_(" +86 "),p(h,{name:"caret-down-small",size:"22px"})]),_:1}),p(s,{class:"w-[1px] h-[40rpx] mx-2.5 ml-1 bg-light"}),p(l,{modelValue:f(I).mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>f(I).mobile=e),disabled:f(z),"no-border":!0,prop:"mobile",type:"text",placeholder:"请输入手机号","custom-class":"!bg-transparent",onFocus:a[4]||(a[4]=e=>F.value=!0),onBlur:a[5]||(a[5]=e=>F.value=!1)},null,8,["modelValue","disabled"])]),_:1},8,["class"]),p(s,{class:w(["flex items-center p-3.5 mt-4 rounded-xl bg-lighter border-2",f(E)?"border-primary":"border-transparent"])},{default:r(()=>[p(l,{modelValue:f(I).code,"onUpdate:modelValue":a[6]||(a[6]=e=>f(I).code=e),"no-border":!0,prop:"code",type:"number",placeholder:"请输入验证码","custom-class":"flex-1 !bg-transparent",onFocus:a[7]||(a[7]=e=>E.value=!0),onBlur:a[8]||(a[8]=e=>E.value=!1)},null,8,["modelValue"]),p(s,{class:"w-[1px] h-[40rpx] mx-2.5 bg-light"}),p(v,{type:"mobile",mobile:f(I).mobile,scene:f(B).BIND_MOBILE},null,8,["mobile","scene"])]),_:1},8,["class"]),p(s,{class:"mt-8"},{default:r(()=>[p(o,{type:"primary",size:"large",block:!0,loading:f(z),disabled:f(z)||!f(I).mobile||!f(I).code,onClick:q},{default:r(()=>[_(" 确认修改 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])):b("",!0)]),_:1})]),_:1})}}}),[["__scopeId","data-v-83224b65"]]);export{z as default};
